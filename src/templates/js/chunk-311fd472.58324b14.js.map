{"version":3,"sources":["webpack:///./src/views/UpdatePublishStatic.vue?5477","webpack:///./src/views/UpdatePublishStatic.vue?1f44","webpack:///./src/views/UpdatePublishStatic.vue?6a08","webpack:///src/views/UpdatePublishStatic.vue","webpack:///./src/views/UpdatePublishStatic.vue?27f1","webpack:///./src/views/UpdatePublishStatic.vue?faf9"],"names":[],"mappings":"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","file":"js/chunk-311fd472.58324b14.js","sourcesContent":["// extracted by mini-css-extract-plugin","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdatePublishStatic.vue?vue&type=style&index=0&id=f2a74e82&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdatePublishStatic.vue?vue&type=style&index=0&id=f2a74e82&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"publish\"},[_c('el-form',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],ref:\"form\",attrs:{\"model\":_vm.publishment,\"rules\":_vm.rules,\"label-width\":\"200px\"}},[_c('el-form-item',{attrs:{\"label\":\"发布名称\"}},[_c('el-input',{attrs:{\"placeholder\":\"eg: develop_youxuan_supplier_web\"},model:{value:(_vm.publishment.name),callback:function ($$v) {_vm.$set(_vm.publishment, \"name\", $$v)},expression:\"publishment.name\"}})],1),_c('el-form-item',{attrs:{\"label\":\"描述\"}},[_c('el-input',{attrs:{\"placeholder\":\"eg: 妈妈优选供应商web端（线下环境）\"},model:{value:(_vm.publishment.description),callback:function ($$v) {_vm.$set(_vm.publishment, \"description\", $$v)},expression:\"publishment.description\"}})],1),_c('el-form-item',{attrs:{\"label\":\"git仓库地址\"}},[_c('el-select',{attrs:{\"filterable\":\"\",\"placeholder\":\"请选择\"},on:{\"click\":function($event){return _vm.list_git_repos()},\"change\":function($event){return _vm.resetBranch()}},model:{value:(_vm.publishment.git_repo_id),callback:function ($$v) {_vm.$set(_vm.publishment, \"git_repo_id\", $$v)},expression:\"publishment.git_repo_id\"}},_vm._l((_vm.git_repo_options),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1),_vm._v(\"*\\n    \")],1),_c('el-form-item',{attrs:{\"label\":\"git分支\"}},[_c('el-select',{attrs:{\"multiple\":\"\",\"placeholder\":\"请选择（单选）\"},on:{\"focus\":function($event){return _vm.get_git_repo_branches()}},model:{value:(_vm.publishment.git_branches),callback:function ($$v) {_vm.$set(_vm.publishment, \"git_branches\", $$v)},expression:\"publishment.git_branches\"}},_vm._l((_vm.git_branch_options),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"发布文件位置（相对）\",\"prop\":\"source_file_dir\"}},[_c('el-input',{attrs:{\"placeholder\":\"eg: assets\"},model:{value:(_vm.publishment.source_file_dir),callback:function ($$v) {_vm.$set(_vm.publishment, \"source_file_dir\", $$v)},expression:\"publishment.source_file_dir\"}})],1),_c('el-form-item',{attrs:{\"label\":\"目标服务器\"}},[_c('el-select',{attrs:{\"multiple\":\"\",\"filterable\":\"\",\"allow-create\":\"\",\"placeholder\":\"请选择或输入（单选）\"},on:{\"focus\":function($event){return _vm.change_ip_group()}},model:{value:(_vm.publishment.to_ip),callback:function ($$v) {_vm.$set(_vm.publishment, \"to_ip\", $$v)},expression:\"publishment.to_ip\"}},_vm._l((_vm.to_ip_options),function(group){return _c('el-option-group',{key:group.label,attrs:{\"label\":group.label}},_vm._l((group.options),function(item){return _c('el-option',{key:item.value,attrs:{\"label\":item.label,\"value\":item.value}})}),1)}),1)],1),_c('el-form-item',{attrs:{\"label\":\"目标服务器项目目录\"}},[_c('el-input',{attrs:{\"placeholder\":\"eg: /data/project/mama_[project_name]\"},model:{value:(_vm.publishment.to_project_home),callback:function ($$v) {_vm.$set(_vm.publishment, \"to_project_home\", $$v)},expression:\"publishment.to_project_home\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.onSubmit}},[_vm._v(\"修改\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"publish\">\n    <el-form ref=\"form\" :model=\"publishment\" :rules=\"rules\" label-width=\"200px\" v-loading=\"loading\">\n      <el-form-item label=\"发布名称\">\n        <el-input v-model=\"publishment.name\" placeholder=\"eg: develop_youxuan_supplier_web\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"描述\">\n        <el-input v-model=\"publishment.description\" placeholder=\"eg: 妈妈优选供应商web端（线下环境）\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"git仓库地址\">\n        <el-select\n          v-model=\"publishment.git_repo_id\"\n          filterable\n          placeholder=\"请选择\"\n          @click=\"list_git_repos()\"\n          @change=\"resetBranch()\"\n        >\n          <el-option\n            v-for=\"item in git_repo_options\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          ></el-option>\n        </el-select>*\n      </el-form-item>\n      <el-form-item label=\"git分支\">\n        <el-select\n          v-model=\"publishment.git_branches\"\n          multiple\n          placeholder=\"请选择（单选）\"\n          @focus=\"get_git_repo_branches()\"\n        >\n          <el-option\n            v-for=\"item in git_branch_options\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          ></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"发布文件位置（相对）\" prop=\"source_file_dir\">\n        <el-input v-model=\"publishment.source_file_dir\" placeholder=\"eg: assets\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"目标服务器\">\n        <el-select\n          v-model=\"publishment.to_ip\"\n          multiple\n          filterable\n          allow-create\n          placeholder=\"请选择或输入（单选）\"\n          @focus=\"change_ip_group()\"\n        >\n          <el-option-group v-for=\"group in to_ip_options\" :key=\"group.label\" :label=\"group.label\">\n            <el-option\n              v-for=\"item in group.options\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n            ></el-option>\n          </el-option-group>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"目标服务器项目目录\">\n        <el-input\n          v-model=\"publishment.to_project_home\"\n          placeholder=\"eg: /data/project/mama_[project_name]\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"onSubmit\">修改</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n</template>\n<script>\nimport http from \"../util/http.js\";\nimport { async } from \"q\";\nexport default {\n  data() {\n    return {\n      publishment: {\n        name: null,\n        description: null,\n        git_repo_id: null,\n        git_branches: null,\n        profile: null,\n        source_file_dir: null,\n        to_ip: null,\n        to_project_home: null\n      },\n      git_repo_options: [],\n      git_branch_options: [],\n      profile_options: [\n        {\n          value: \"dev\",\n          label: \"开发环境（dev）\"\n        },\n        {\n          value: \"test\",\n          label: \"测试环境（test）\"\n        },\n        {\n          value: \"pre\",\n          label: \"预发环境（pre）\"\n        },\n        {\n          value: \"online\",\n          label: \"生产环境（online）\"\n        }\n      ],\n      to_ip_options: [\n        {\n          label: \"线下\",\n          options: [\n            {\n              value: \"192.168.1.248\",\n              label: \"192.168.1.248\"\n            },\n            {\n              value: \"192.168.1.249\",\n              label: \"192.168.1.249\"\n            },\n            {\n              value: \"192.168.1.251\",\n              label: \"192.168.1.251\"\n            }\n          ]\n        },\n        {\n          label: \"预发\",\n          options: [\n            {\n              value: \"47.96.18.198\",\n              label: \"47.96.18.198\"\n            }\n          ]\n        },\n        {\n          label: \"线上\",\n          options: [\n            {\n              value: \"114.55.232.195\",\n              label: \"114.55.232.195\"\n            },\n            {\n              value: \"118.178.128.57\",\n              label: \"118.178.128.57\"\n            },\n            {\n              value: \"47.110.153.206\",\n              label: \"47.110.153.206\"\n            },\n            {\n              value: \"47.110.154.253\",\n              label: \"47.110.154.253\"\n            }\n          ]\n        }\n      ],\n      rules: {\n        name: [\n          { required: true, message: \"请输入发布名称\", trigger: \"blur\" },\n          { min: 3, max: 50, message: \"长度在3到50个字符\", trigger: \"blur\" }\n        ],\n        description: [\n          { required: true, message: \"请输入发布名称\", trigger: \"blur\" },\n          { min: 5, max: 100, message: \"长度在5到100个字符\", trigger: \"blur\" }\n        ],\n        git_repo_id: [\n          { required: true, message: \"请选择git仓库地址\", trigger: \"change\" }\n        ],\n        git_branches: [\n          { required: true, message: \"请选择git分支名称\", trigger: \"change\" }\n        ],\n        profile: [\n          { required: true, message: \"请选择发布环境\", trigger: \"change\" }\n        ],\n        to_ip: [\n          { required: true, message: \"请选择目标服务器ip\", trigger: \"change\" }\n        ],\n        to_project_home: [\n          {\n            required: true,\n            message: \"请输入目标服务器项目主目录\",\n            trigger: \"blur\"\n          }\n        ]\n      },\n      loading: false\n    };\n  },\n  methods: {\n    get_publishment() {\n      http.get(\"/publishmentStatic/\" + this.$route.query.id).then(response => {\n        this.publishment = response.data;\n      });\n    },\n    list_git_repos() {\n      this.loading = true;\n      http\n        .get(\"/git/repos\")\n        .then(response => {\n          this.git_repo_options.length = 0;\n          response.data.forEach(repo => {\n            this.git_repo_options.push({\n              value: repo.id,\n              label: repo.ssh_url_to_repo + \" (\" + repo.description + \")\"\n            });\n          });\n        })\n        .catch(error => {\n          this.$message.error(\"查询失败\");\n        })\n        .then(() => {\n          this.loading = false;\n        });\n    },\n    get_git_repo_branches() {\n      if (!this.publishment.git_repo_id) {\n        return;\n      }\n      this.loading = true;\n      http\n        .get(\"/git/repo/\" + this.publishment.git_repo_id + \"/branches\")\n        .then(response => {\n          this.git_branch_options.length = 0;\n          response.data.forEach(branch => {\n            this.git_branch_options.push({ value: branch, label: branch });\n          });\n        })\n        .then(() => {\n          this.loading = false;\n        });\n    },\n    change_ip_group() {\n      if (!this.publishment.profile) {\n        return;\n      }\n      // if (this.publishment.profile == 'dev') {\n      //   this.to_ip_options.length = 0;\n      //   this.to_ip_options.push(this._to_ip_options[0]);\n      // } else if (this.publishment.profile == 'pre') {\n      //   this.to_ip_options.length = 0;\n      //   this.to_ip_options.push(this._to_ip_options[1]);\n      // } else if (this.publishment.profile == 'online') {\n      //   this.to_ip_options.length = 0;\n      //   this.to_ip_options.push(this._to_ip_options[2]);\n      // }\n    },\n    sleep(ms) {\n      return new Promise(resolve => setTimeout(resolve, ms));\n    },\n    resetBranch() {\n      this.publishment.git_branches = null;\n    },\n    onSubmit() {\n      http\n        .request({\n          url: \"/publishmentStatic\",\n          method: \"POST\",\n          data: this.publishment\n        })\n        .then(response => {\n          this.$message({\n            showClose: true,\n            message: \"修改成功\",\n            type: \"success\"\n          });\n          // this.sleep(1200).then(() => {\n          //   this.$router.go(0);\n          // });\n          this.get_publishment();\n        })\n        .catch(error => {\n          this.$message.error(\"保存失败\");\n        });\n    }\n  },\n  mounted() {\n    // document.getElementById(\"static\").className =\n    //   document.getElementById(\"static\").className + \" el-menu-item is-active\";\n  },\n  created() {\n    this.list_git_repos();\n    this.get_git_repo_branches();\n    this.get_publishment();\n  }\n};\n</script>\n<style scoped>\n.publish {\n  width: 800px;\n  margin: auto;\n}\n.publish .el-select {\n  width: 500px;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdatePublishStatic.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UpdatePublishStatic.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UpdatePublishStatic.vue?vue&type=template&id=f2a74e82&scoped=true&\"\nimport script from \"./UpdatePublishStatic.vue?vue&type=script&lang=js&\"\nexport * from \"./UpdatePublishStatic.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UpdatePublishStatic.vue?vue&type=style&index=0&id=f2a74e82&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f2a74e82\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}